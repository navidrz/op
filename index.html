<!DOCTYPE html>
<html lang="fa-IR">
<head>
  <!-- [1] Set character encoding and viewport -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- [2] Page title and description -->
  <title>ฺฏุฒุงุฑุด ุฌุงูุน ุงุฒ ุฏุงุฏูโูุง ุงุฎุชุงุฑุงุช ุจุงุฒุงุฑ | ุงุฑุงู ุจูุฑุณ</title>
  <meta name="description" content="ฺฏุฒุงุฑุด ุฌุงูุน ู ุชุญูู ุงุฒ ุฏุงุฏูโูุง ุงุฎุชุงุฑุงุช ุจุงุฒุงุฑ ุฏุฑ ุงุฑุงู ุจูุฑุณ. ุจุฑุง ุชุตููโฺฏุฑ ุจูุชุฑ ุฏุฑ ูุนุงููุงุช ุขูพุดูโูุงุ ููุชุฑูุง ู ูุชุฑฺฉโูุง ฺฏููุงฺฏูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ.">
  
  <!-- [3] Manifest and theme color for PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2ecc71">
  
  <!-- [4] Preconnect for performance -->
  <link rel="preconnect" href="https://cdn.tsetmc.com" crossorigin>
  <link rel="dns-prefetch" href="https://cdn.tsetmc.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  
  <!-- [5] Load Vazir font -->
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet" type="text/css" />
  
  <!-- [6] Main stylesheet -->
  <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-mode">
<!-- [7] Hidden container for capturing images -->
<div id="captureContainer"></div>

<!-- [8] Dark mode toggle -->
<div class="dark-mode-toggle-container">
  <label>
    <span class="mode-icon">๐</span>
    <input type="checkbox" id="darkModeToggle" aria-pressed="false" aria-label="ุชุบุฑ ุญุงูุช ุชู">
    <span class="toggle"></span>
    <span class="mode-icon">๐</span>
  </label>
</div>

<!-- [9] Tour button -->
<button id="tourBtn" aria-label="ุฑุงูููุง ุชูุฑ">โน๏ธ ุฑุงูููุง</button>

<!-- [10] Header with logo and title -->
<header role="banner">
  <a href="/" title="ุตูุญู ุงุตู ุงุฑุงู ุจูุฑุณ">
    <img src="images/iranbourse2024-3.png" alt="ุงุฑุงู ุจูุฑุณ" style="float:right;max-width:150px;margin-left:10px;">
  </a>
  <h1>ฺฏุฒุงุฑุด ุฌุงูุน ุงุฒ ุฏุงุฏูโูุง ุงุฎุชุงุฑุงุช ุจุงุฒุงุฑ | ุงููููุฑุงู ุจูููููุฑุณ</h1>
</header>

<!-- [11] Tips section -->
<div id="tipsSection"><p id="tipText">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ูฺฉุงุช...</p></div>

<!-- [12] Scenario story -->
<div id="scenarioStory" role="region" aria-live="polite"></div>

<!-- [13] Summary cards -->
<div id="summary" role="region" aria-label="ุฎูุงุตู ุขูุงุฑ">
  <div class="card">
    <h3>ุจูุชุฑู ุขูพุดู ุฎุฑุฏ (CALL)</h3>
    <p id="bestLongCall">...</p>
  </div>
  <div class="card">
    <h3>ุจูุชุฑู ุขูพุดู ูุฑูุด (CALL)</h3>
    <p id="bestShortCall">...</p>
  </div>
  <div class="card">
    <h3>ุจูุชุฑู ุขูพุดู ุฎุฑุฏ (PUT)</h3>
    <p id="bestLongPut">...</p>
  </div>
  <div class="card">
    <h3>ุจูุชุฑู ุขูพุดู ูุฑูุด (PUT)</h3>
    <p id="bestShortPut">...</p>
  </div>
</div>

<!-- [14] Filter Bar -->
<div id="filterBar" role="region" aria-label="ููุชุฑูุง ู ุชูุธูุงุช ููุงุด">
  <input type="text" id="searchInput" placeholder="ุฌุณุชุฌู..." aria-label="ุฌุณุชุฌู ุจุฑ ุงุณุงุณ ูุงู ุขูพุดู">
  <select id="marketScenarioSelect" aria-label="ุงูุชุฎุงุจ ุณูุงุฑู ุจุงุฒุงุฑ">
    <option value="">ุชูุงู ุณูุงุฑููุง</option>
  </select>
  <select id="userMarketViewSelect" aria-label="ุงูุชุฎุงุจ ุฏุฏฺฏุงู ุจุงุฒุงุฑ">
    <option value="">ุชูุงู ุฏุฏฺฏุงูโูุง</option>
  </select>
  <div class="strategy-toggle" aria-label="ุชูุธู ููุงุด ุงุณุชุฑุงุชฺ">
    ููุงุด ุงุณุชุฑุงุชฺ:
    <label><input type="radio" name="strategy" value="both" checked>ูุฑุฏู</label>
    <label><input type="radio" name="strategy" value="long">ููุท ุฎุฑุฏ</label>
    <label><input type="radio" name="strategy" value="short">ููุท ูุฑูุด</label>
  </div>
  <div id="filterInfo" aria-live="polite">ููุชุฑโูุง: 
    <span id="filterScenario">ุณูุงุฑู: ููู</span> |
    <span id="filterView">ุฏุฏฺฏุงู: ููู</span> |
    <span id="filterSearch">ุฌุณุชุฌู: ุจุฏูู ูุชู</span>
  </div>
</div>

<!-- [15] Recommendations -->
<div id="recommendations" role="region" aria-label="ูพุดููุงุฏูุง ุจุฑุชุฑ">
  <h2>ูพุดููุงุฏูุง ุจุฑุชุฑ</h2>
  <p class="recommendation-explanation">
    ุฏุฑ ุงู ุจุฎุดุ ุจูุชุฑู ุขูพุดูโูุง ุฑุง ุจุฑ ุงุณุงุณ ุฌุฐุงุจุช (ูุณุจุช ุดุงุฑูพ) ูุดุงูุฏู ูโฺฉูุฏ.
    ุงฺฏุฑ ุขูพุดู ุงูู ุจุง ุงุฎุชูุงู ฺุดูฺฏุฑ ูพุดุชุงุฒ ุจุงุดุฏุ ุจุง ุฐฺฉุฑ "ุจุง ุงุฎุชูุงู ฺุดูฺฏุฑ" ููุงุด ุฏุงุฏู ูโุดูุฏ.
  </p>
  <div style="display:flex; gap:20px; flex-wrap:wrap; width:100%; justify-content:center;">
    <div class="recommendation-col" id="topLongCol">
      <h3>ุจุฑุชุฑูโูุง (ุฎุฑุฏ) ๐ฑ</h3>
      <div id="topLongList"></div>
    </div>
    <div class="recommendation-col" id="topShortCol">
      <h3>ุจุฑุชุฑูโูุง (ูุฑูุด) ๐ป</h3>
      <div id="topShortList"></div>
    </div>
  </div>
</div>

<!-- [16] Favorites Section -->
<div id="favoritesSection">
  <h2>ุนูุงููโููุฏโูุง ุดูุง:</h2>
  <div id="favoritesList"></div>
</div>

<!-- [17] Metric Selector -->
<div id="metricSelector">
  <h2>ุงูุชุฎุงุจ ูุชุฑฺฉโูุง ููุงุด:</h2>
  <label><input type="checkbox" class="metric-check" value="payout" checked> ุจุงุฒุฏู</label>
  <label><input type="checkbox" class="metric-check" value="pop" checked> PoP</label>
  <label><input type="checkbox" class="metric-check" value="risk" checked> CVaR (ุฑุณฺฉ)</label>
  <label><input type="checkbox" class="metric-check" value="commentary" checked> ุชูุณุฑ</label>
  <label><input type="checkbox" class="metric-check" value="sharpe" checked> ูุณุจุช ุดุงุฑูพ</label>
</div>

<!-- [18] Data Container -->
<div id="dataContainer" role="region" aria-label="ูุณุช ุขูพุดูโูุง"></div>

<!-- [19] Bottom Bar (Mobile) -->
<div class="bottom-bar" role="region" aria-label="ฺฉูุชุฑูโูุง ุงุถุงู ููุจุงู">
  <button id="loadMoreBtn">ููุงุฑุฏ ุจุดุชุฑ</button>
  <button id="scrollTopBtn">โ ุจุงูุง</button>
  <button id="exportBtn">ุฏุงูููุฏ CSV</button>
</div>

<!-- [20] Go Top Button -->
<button id="goTopBtn" aria-label="ุฑูุชู ุจู ุจุงูุง">โ</button>

<!-- [21] Loading Overlay -->
<div id="loadingOverlay" aria-busy="true" aria-label="ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ...">
  <div class="spinner"></div>
</div>

<!-- [22] Compare Bar -->
<div id="compareBar">
  <span>ูุณุช ููุงุณู:</span>
  <div id="compareList"></div>
  <button id="compareBtn">ููุงุณู ฺฉู</button>
</div>

<!-- [23] Compare Modal -->
<div id="compareModal">
  <div id="compareModalContent">
    <h2>ููุงุณู ุขูพุดูโูุง</h2>
    <table class="compare-table">
      <thead>
        <tr>
          <th>ูุงู ุขูพุดู</th>
          <th>ูุณุจุช ุดุงุฑูพ ุฎุฑุฏ</th>
          <th>ูุณุจุช ุดุงุฑูพ ูุฑูุด</th>
        </tr>
      </thead>
      <tbody id="compareTableBody"></tbody>
    </table>
    <button class="close-compare">ุจุณุชู</button>
  </div>
</div>

<!-- [24] Badge Popup -->
<div id="badgePopup">๐ ุขูุฑู! ุดูุง ฺฉ ุงูุชุฎุงุจ ุจุฑุชุฑ ุฑุง ุจู ุนูุงููโููุฏโูุง/ูุงฺฉโูุง ุงูุฒูุฏุฏ! <span class="icon">๐</span></div>

<!-- [25] Tour Overlay -->
<div id="tourOverlay">
  <p id="tourText">ุฎูุด ุขูุฏุฏ! ุฏุฑ ุงู ุตูุญู ูโุชูุงูุฏ ุขูพุดูโูุง ูุฎุชูู ุฑุง ุจุฑุฑุณ ู ููุชุฑ ฺฉูุฏ.</p>
  <button id="tourNextBtn">ุจุนุฏ</button>
  <button id="tourCloseBtn">ุจุณุชู</button>
</div>

<!-- [26] External scripts (html2canvas, PapaParse) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>

<!-- [27] Main app JS -->
<script src="app.js" defer></script>

</body>
</html>
